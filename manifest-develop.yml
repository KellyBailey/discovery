---
applications:
- name: discovery-test
  host: disc-test
  path: .
  buildpack: https://github.com/cloudfoundry/python-buildpack
  command: python manage.py migrate --noinput && python manage.py createcachetable && python manage.py collectstatic --noinput && waitress-serve --expose-tracebacks --port=$PORT discovery.wsgi:application
  instances: 1
  memory: 128M
  disk_quota: 1G
  timeout: 180
  services:
    - discovery-config
    - discovery-db
    - discovery-redis
- name: discovery-celery
  path: .
  no-route: true
  health-check-type: process
  buildpack: https://github.com/cloudfoundry/python-buildpack
  command: celery -A discovery worker --loglevel=info --concurrency=1
  instances: 1
  memory: 832M
  disk_quota: 1G
  timeout: 180
  services:
    - discovery-config
    - discovery-db
    - discovery-redis
- name: discovery-celerybeat
  path: .
  no-route: true
  health-check-type: process
  buildpack: https://github.com/cloudfoundry/python-buildpack
  command: celery -A discovery beat --loglevel=info
  instances: 1
  memory: 64M
  disk_quota: 1G
  timeout: 180
  services:
    - discovery-config
    - discovery-db
    - discovery-redis