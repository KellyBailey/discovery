schema_version: "3.0.0"
name: Access Control Policies for Discovery

references:
- name: Discovery Github Repository
  path: https://github.com/PSHCDevOps/discovery
  type: URL

- name: Discovery Circle CI
  path: https://circleci.com/gh/PSHCDevOps/discovery
  type: URL

- name: Discovery Documentation Site
  path: http://pshcdevops.github.io/discovery/
  type: URL


verifications:
- key: cloudteam
  name: Cloud.gov - Managing Team Members
  path: https://cloud.gov/docs/apps/managing-teammates
  type: URL

- key: gitteam
  name: GitHub - Managing Organization Teams
  path: https://help.github.com/categories/setting-up-and-managing-organizations-and-teams
  type: URL

- key: circleci
  name: CircleCI - GitHub Integration
  path: https://circleci.com/docs/2.0/
  type: URL

- key: django
  name: Django Documentation
  path: https://docs.djangoproject.com/en/1.8/
  type: URL


satisfies:
- standard_key: NIST-800-53
  control_key: AC-2 # Account Management
  implementation_status: complete
  covered_by:
    - verification_key: cloudteam
    - verification_key: gitteam
    - verification_key: circleci
    - verification_key: django
  narrative:
    - key: AC-2a
      text: |
        _Control:_ **The organization identifies and selects the following types of information system accounts to support organizational missions/business functions: individual, group, system, application, guest/anonymous, and temporary accounts**

        The Discovery application has defined several granular roles, both at the infrasructure and application level, that allow for fine grained permissions.  On the infrastructure side these include Cloud.gov organization manager, auditor, and billing manager, Cloud.gov space managers, developers, and auditors, GitHub maintainers and external contributors, and CircleCI service managers.  For the application most traffic is served up to public anonymous traffic, but we do have Django site administrators capable of modifying users, content, and managing periodic tasks.

        Each role is inhabited by only those people who need that ability.  Role membership can often overlap due to the smaller number of internal staff and contractors working on the system at any given time.

    - key: AC-2b
      text: |
        _Control:_ **The organization assigns account managers for information system accounts**

        The PSHC Discovery management team assigns staff and contractors access to roles discussed in AC-2a only as needed and access is limited to the roles needed to accomplish their missions.  The PSHC may delegate management of certain responsibilities to other staff members or contractors working on the platform if the system can benefit from their management.  All managers are either GSA staff or current contractors.

    - key: AC-2c
      text: |
        _Control:_ **The organization establishes conditions for group and role membership**

        All Discovery related roles defined in AC-2a have clearly defined permissions and duties and they do not overlap.  A GSA staff member or current contractor may be granted access to a role if they need the permissions or abilities to perform their management approved duties.

    - key: AC-2e
      text: |
        _Control:_ **The organization requires approvals by GSA S/SO or Contractor recommendation to be approved and accepted by the GSA AO for requests to create information system accounts**

        All account created for both infrastructure hosting Discovery application components and application administrative accounts are created by GSA staff that manage the Discovery system or under the request of a designated contractor.  All Cloud.gov accounts are created by the Cloud.gov management team in line with their current FedRAMP'd security controls and assigned to the Discovery organizations.  Discovery management then assigns the users roles needed to accomplish their objectives.

    - key: AC-2f
      text: |
        _Control:_ **The organization creates, enables, modifies, disables, and removes information system accounts in accordance with GSA S/SO or Contractor recommendation to be approved and accepted by the GSA AO**

        All Discovery roles, both infrastructure and application related, are designed to allow for easy onboarding and offboarding based on the underlying need of the GSA staff member of contractor.  The Discovery management team approves all new users and role changes, and regular audits are performed to ensure least privilege access controls are in place.

    - key: AC-2j
      text: |
        _Control:_ **The organization reviews accounts for compliance with account management requirements at leasy annually**

        The Discovery management team or a delgated staff member of contractor performs regular audits of the users having access to a particular infrastructure or application role, and either corrects access permissions (if part of the Discovery management team) or makes recommendations to the Discovery Management team for further action.

        It is also possible that the Cloud.gov team might revoke a user currently having access to the Discovery Cloud.gov organization and related spaces based on their defined and approved security controls.

- standard_key: NIST-800-53
  control_key: AC-3 # Access Enforcement
  implementation_status: complete
  covered_by:
    - verification_key: cloudteam
    - verification_key: gitteam
    - verification_key: circleci
    - verification_key: django
  narrative:
    - text: |
        _Control:_ **The information system enforces approved authorizations for logical access to information and system resources in accordance with applicable access control policies**

        All vendor and contract data within the [Discovery repository](https://github.com/PSHCDevOps/discovery) is openly available to the public so no access control is required.  Discovery site administrators granted according to AC-2 must authenticate through a Django authentication, authorization, and session management system.

        All Cloud.gov system access is handled according to policies outlined in the AC-2 controls and Cloud.gov's implemented security controls.  All access to hosting environments (production and development) are fully self contained and access must be individually granted to each environment.

        All GitHub, CircleCI, and related service accounts provide accounts especially tailored to their service offerings and do not interfere with one another.  As stated in AC-2, the Discovery management team may grant GSA staff and current contractors access to these services as needed.

- standard_key: NIST-800-53
  control_key: AC-6 # Least Privilege
  implementation_status: complete
  narrative:
    - text: |
        _Control:_ **The organization employs the principle of least privilege, allowing only authorized accesses for users (or processes acting on behalf of users) which are necessary to accomplish assigned tasks in accordance with organizational missions and business functions**

        The Discovery management team adheres to the principle of least privilege by assigning only the requisite role access needed to perform the functions of the GSA staff member of current contractor.  Users inhabit a role only as long as they need that role to perform their functions.

        Role membership is revoked either when the GSA staff member or contractor leaves the project, the Discovery management team deems it necessary, or if the role capabilities are no longer needed by the current GSA staff member or contractor.  When role membership is needed again it is regranted under the direction of the Discovery management team.
